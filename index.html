<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit Suggestion Engine</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        input, select, button { margin: 5px; padding: 10px; }
    </style>
</head>
<body>
    <h1>Habit Suggestion Engine</h1>
    <input type="number" id="age" placeholder="Enter your age" required>
    <select id="goal" required>
        <option value="">Select a goal</option>
        <option value="fitness">Fitness</option>
        <option value="productivity">Productivity</option>
        <option value="wellness">Wellness</option>
    </select>
    <button id="suggest">Get Habit Suggestion</button>
    <div id="suggestion"></div>

    <script>
        // Sample habit data
        const data = [
            { age: 25, goal: 'fitness', habit: '30-minute run' },
            { age: 25, goal: 'fitness', habit: 'join a gym' },
            { age: 25, goal: 'fitness', habit: 'do yoga for 20 minutes' },
            { age: 30, goal: 'productivity', habit: '10 minutes meditation' },
            { age: 30, goal: 'productivity', habit: 'write a daily journal' },
            { age: 30, goal: 'productivity', habit: 'set daily goals' },
            { age: 22, goal: 'wellness', habit: 'drink 2 liters of water' },
            { age: 22, goal: 'wellness', habit: 'take a walk in nature' },
            { age: 22, goal: 'wellness', habit: 'practice gratitude daily' },
            { age: 35, goal: 'fitness', habit: 'go cycling for 30 minutes' },
            { age: 40, goal: 'wellness', habit: 'meditate for 10 minutes' },
            { age: 28, goal: 'productivity', habit: 'read for 30 minutes' }
        ];

        const habitList = [
            '30-minute run', 
            'join a gym', 
            'do yoga for 20 minutes', 
            '10 minutes meditation', 
            'write a daily journal', 
            'set daily goals', 
            'drink 2 liters of water', 
            'take a walk in nature', 
            'practice gratitude daily', 
            'go cycling for 30 minutes', 
            'meditate for 10 minutes', 
            'read for 30 minutes'
        ];

        // Function to encode the goal
        function encodeGoal(goal) {
            return [
                goal === 'fitness' ? 1 : 0,
                goal === 'productivity' ? 1 : 0,
                goal === 'wellness' ? 1 : 0
            ];
        }

        // Prepare input and output tensors
        const inputs = tf.tensor2d(data.map(item => [item.age, ...encodeGoal(item.goal)]));
        const outputs = tf.tensor2d(data.map(item => {
            const habitIndex = habitList.indexOf(item.habit);
            return habitList.map((_, index) => index === habitIndex ? 1 : 0);
        }));

        // Create the model
        const model = tf.sequential();
        model.add(tf.layers.dense({ units: 10, activation: 'relu', inputShape: [4] }));
        model.add(tf.layers.dense({ units: habitList.length, activation: 'softmax' }));
        model.compile({ optimizer: 'adam', loss: 'categoricalCrossentropy', metrics: ['accuracy'] });

        // Train the model
        async function trainModel() {
            await model.fit(inputs, outputs, {
                epochs: 100,
                callbacks: {
                    onEpochEnd: (epoch, logs) => console.log(`Epoch: ${epoch}, Loss: ${logs.loss}`)
                }
            });
            console.log('Model training complete!');
        }

        // Suggest habit based on user input
        async function suggestHabit(age, goal) {
            const goalEncoding = encodeGoal(goal);
            const inputTensor = tf.tensor2d([[age, ...goalEncoding]]);
            const predictions = model.predict(inputTensor);
            const predictedIndex = (await predictions.argMax(-1).data())[0];
            document.getElementById('suggestion').innerText = `Suggested habit: ${habitList[predictedIndex]}`;
        }

        // Event listener for the suggest button
        document.getElementById('suggest').onclick = () => {
            const age = parseInt(document.getElementById('age').value);
            const goal = document.getElementById('goal').value;
            if (age && goal) {
                suggestHabit(age, goal);
            } else {
                alert("Please enter your age and select a goal.");
            }
        };

        // Train the model on page load
        trainModel();
    </script>
</body>
</html>